---
title: "TME-Pisaura"
output: html_document
editor_options:
  chunk_output_type: console
---


## Packages

```{r packages}
require(ggplot2)
require(ggpubr)
require(tidyverse)
require(data.table)
require(rstatix)
require(ggpubr)
require(lme4)
require(lmerTest)
```

## Harvest data

```{r data-harvest}
#read table
TME = fread("TME_Pisaura_data.csv", header = TRUE, encoding = 'Latin-1', stringsAsFactors = FALSE)

```

## Prepare data

```{r data-preparation}
TMEnoNA = na.omit(TME)
names(TME)[names(TME) == "t_on_start side"] <- "t_on_start_side"
names(TMEnoNA)[names(TMEnoNA) == "t_on_start side"] <- "t_on_start_side"
gsub('c', 'C', TME$side_start)
gsub('c', 'C', TMEnoNA$side_start)

TMEnoNA = TMEnoNA %>%
  convert_as_factor(family, id, Camera, round, side_start, side_opp., day_test)
```

## Manipulate data

```{r data-manipulation}
#TODO H1: Individuals spend more time on the same side in various observations
# if an individual spends much time on one side, the chance is higher that it will spend more time on this side the next time


#TODO H2: The time spend on side with cue is dependent on the age of a spider (cricket boldness ontogeny Niemelä 2011).
# model fitting to y=t_on_C, x=age_test
ggplot(data=TMEnoNA, aes(x=day_test, y=t_on_C))+
  geom_jitter(colour='grey60',position=position_jitter(0.03))+
  geom_line(aes(group=id),colour='grey70')+
  geom_boxplot(outlier.colour='black', outlier.shape=16, alpha=0.5) +
  stat_compare_means(comparisons=list(c(1,2),c(2,3),c(1,3)),method='t.test', label='p.signif') +
  theme_bw()

lm2 =lm(t_on_C ~ age_test, data=TMEnoNA)
summary(lm2)
#low R² so lm does not fit


#TODO H3: Families share similar boldness scores.
ggboxplot(TMEnoNA$boldness)
ggplot(data=TMEnoNA, aes(x=day_test, y=boldness))+
  geom_point(aes(color=family)) +
  geom_line(aes(group=id,color=family))

#TODO H4: An individual shows similar activity and boldness over various observations.



#TODO H5: Individuals show differences in activity and boldness, thus imply having a personality.




```